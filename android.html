<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DAL Answer (Android)</title>
<style>
  /* Ensure page can scroll smoothly on Android */
  html, body {
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  /* Restored blue background */
  body {
    margin: 0;
    padding: 12px;
    background: #007BFF; /* Replace this if your original hex was different */
    font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    line-height: 1.45;
  }

  /* White output container */
  .container {
    background: #fff;
    border: 3px solid #F0C40F;
    border-radius: 12px;
    padding: 12px;
  }

  #out {
    font-size: 16px;
  }

  /* Clickable, styled links */
  a {
    word-break: break-all;
    color: #0645AD;
    text-decoration: underline;
    cursor: pointer; /* Required for proper touch detection on Android */
  }
</style>
<script src="https://thunkable.github.io/webviewer-extension/thunkableWebviewerExtension.js"></script>
</head>
<body>
  <div class="container"><div id="out">READY</div></div>

<script>
  const out = document.getElementById('out');

  // Escape HTML special characters
  function esc(s){
    return String(s||'').replace(/[&<>"']/g, c => (
      { '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c]
    ));
  }

  // Convert URLs to clickable links and preserve line breaks
  function linkify(s){
    return esc(s)
      .replace(/(https?:\/\/[^\s<]+)/g, '<a href="$1" target="_blank" rel="noopener">$1</a>')
      .replace(/\n/g,'<br>');
  }

  // Signal readiness to Thunkable
  try { ThunkableWebviewerExtension.postMessage('ready-android'); } catch(e){}

  // Receive and render content
  ThunkableWebviewerExtension.receiveMessage(function(message){
    out.innerHTML = linkify(message);
  });

  // Intercept clicks on links and open them via the native app
  document.addEventListener('click', (e) => {
    const a = e.target.closest('a');
    if(!a) return;
    e.preventDefault();
    try {
      ThunkableWebviewerExtension.postMessage(JSON.stringify({type:'open-url', url:a.href}));
    } catch(_){}
  });
</script>
</body>
</html>
